(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ab7"],{"150e":function(e,t,a){"use strict";var i=a("6666"),o=a.n(i);o.a},2073:function(e,t,a){"use strict";var i=a("d937"),o=a.n(i);o.a},"547c":function(e,t,a){"use strict";a("7f7f");var i=a("c93e"),o=a("9bd2"),l=a("ba4a"),r=Object(i["a"])({},l["a"],{requestImportTask:function(e,t){Object(o["a"])({url:"/compre/imp/find/self?page="+e.page+"&pageSize="+e.pageSize+"&dataType="+e.dataType,method:"get"}).then(function(e){t(e)})},requestSaveTask:function(e,t){Object(o["a"])({url:"/compre/imp/data/"+e.url+"?districtCode="+e.districtCode+"&fileId="+e.fileId+"&name="+e.name+"&key="+e.key,method:"post"}).then(function(e){t(e)})},requestQueryRelaDataList:function(e,t){Object(o["a"])({url:"/compre/hp/"+e.queryUrl+"?page="+e.page+"&pageSize="+e.pageSize,method:"get"}).then(function(e){t(e)})},requestRelaBuildData:function(e,t){Object(o["a"])({url:"/compre/hp/buildinfo/relaBuildingCode",data:e,method:"post"}).then(function(e){t(e)})},requestRelaHouseData:function(e,t){Object(o["a"])({url:"/compre/hp/house/relaBuildingCode",data:e,method:"post"}).then(function(e){t(e)})},requestRelaPeopleData:function(e,t){Object(o["a"])({url:"/compre/hp/people/rela",data:e,method:"post"}).then(function(e){t(e)})}});t["a"]=r},6666:function(e,t,a){},ba4a:function(e,t,a){"use strict";a("7f7f");var i=a("9bd2"),o={requestGridCode:function(e){Object(i["a"])({url:"/grid/rstu/find/all/code",method:"get"}).then(function(t){t.region=_.sortBy(t.region,"code");var a=constants.REGION.CODE,i={code:a,label:constants.REGION.NAME,children:[]},o={};switch(a&&a.length){case 4:o=_.map(t.region,function(e){return{code:e.code,label:e.name,children:[]}}),_.map(o,function(e){e.children=_.map(_.filter(t.street,function(t){return t.code.indexOf(e.code)>=0}),function(e){return{code:e.code,label:e.name,children:[]}})}),_.map(o,function(e){_.map(e.children,function(e){e.children=_.map(_.filter(t.community,function(t){return t.code.indexOf(e.code)>=0}),function(e){return{code:e.code,label:e.name,children:[]}})})}),_.map(o,function(e){_.map(e.children,function(e){_.map(e.children,function(e){e.children=_.map(_.filter(t.unit,function(t){return t.code.indexOf(e.code)>=0}),function(e){return{code:e.code,label:e.name}})})})});break;case 6:o=_.map(_.filter(t.street,function(e){return e.code.indexOf(a)>=0}),function(e){return{code:e.code,label:e.name,children:[]}}),_.map(o,function(e){e.children=_.map(_.filter(t.community,function(t){return t.code.indexOf(e.code)>=0}),function(e){return{code:e.code,label:e.name,children:[]}})}),_.map(o,function(e){_.map(e.children,function(e){e.children=_.map(_.filter(t.unit,function(t){return t.code.indexOf(e.code)>=0}),function(e){return{code:e.code,label:e.name}})})});break;case 9:o=_.map(_.filter(t.community,function(e){return e.code.indexOf(a)>=0}),function(e){return{code:e.code,label:e.name,children:[]}}),_.map(o,function(e){e.children=_.map(_.filter(t.unit,function(t){return t.code.indexOf(e.code)>=0}),function(e){return{code:e.code,label:e.name}})});break;case 12:o=_.map(_.filter(t.unit,function(e){return e.code.indexOf(a)>=0}),function(e){return{code:e.code,label:e.name}});break;default:break}i.children=o,e(i)})},requestDicCatalog:function(e){Object(i["a"])({url:"/buss/info/dictionary/catalog/findAll",method:"get"}).then(function(t){e(t)})},requestDicType:function(e,t){Object(i["a"])({url:"/buss/info/dictionary/findDicByCatalogId?catalogId="+e,method:"get"}).then(function(e){t(e)})},requestByEntityNames:function(e,t){Object(i["a"])({url:"/compre/statis/common/district?districtCode="+e.districtCode+"&entityNames="+e.entityNames,method:"get"}).then(function(e){t(e)})},requestByFieldName:function(e,t){Object(i["a"])({url:"/compre/statis/common/field?districtCode="+e.districtCode+"&entityName="+e.entityName+"&fieldName="+e.fieldName,method:"get"}).then(function(e){t(e)})},requestByEntityAndFieldSum:function(e,t){Object(i["a"])({url:"/compre/statis/common/district/field/sum?districtCode="+e.districtCode+"&entityName="+e.entityName+"&fieldName="+e.fieldName,method:"get"}).then(function(e){t(e)})},requestFocusPeople:function(e,t){Object(i["a"])({url:"/compre/hp/people/find/compreInfo?id="+e,method:"get"}).then(function(e){t(e)})},requestFocus:function(e,t){Object(i["a"])({url:"/compre/"+e.entity+"/find?id="+e.focusId,method:"get"}).then(function(e){t(e)})}};t["a"]=o},c65c:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"import-data-page"},[a("div",{staticClass:"page-top"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},[a("el-tab-pane",{attrs:{label:"楼栋任务",name:"1"}},[a("ImportList",{ref:"ImportList",attrs:{fileUrl:e.fileUrl,fileName:e.fileName,tableData:e.tableData},on:{onImport:e.handleImport}})],1),a("el-tab-pane",{attrs:{label:"户任务",name:"2"}},[a("ImportList",{ref:"ImportList",attrs:{fileUrl:e.fileUrl,fileName:e.fileName,tableData:e.tableData},on:{onImport:e.handleImport}})],1),a("el-tab-pane",{attrs:{label:"流动人口任务",name:"3"}},[a("ImportList",{ref:"ImportList",attrs:{fileUrl:e.fileUrl,fileName:e.fileName,tableData:e.tableData},on:{onImport:e.handleImport}})],1),a("el-tab-pane",{attrs:{label:"户籍人口任务",name:"4"}},[a("ImportList",{ref:"ImportList",attrs:{fileUrl:e.fileUrl,fileName:e.fileName,tableData:e.tableData},on:{onImport:e.handleImport}})],1)],1)],1),a("div",{staticClass:"techo-list__pager"},[a("el-pagination",{ref:"pager",attrs:{"page-sizes":[10,20,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:e.recordCount},on:{"size-change":e.getPageInfo,"current-change":e.getPageInfo}})],1),a("ImportDialog",{ref:"ImportDialog",attrs:{disCodeOption:e.disCodeOption,saveUrl:e.saveUrl},on:{onSubmit:e.submitForm}})],1)},o=[],l=(a("7f7f"),a("547c")),r=a("1fba"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"import-dialog",attrs:{title:"导入数据",visible:e.dialogVisible,width:"30%","close-on-click-modal":e.isImport,"close-on-press-escape":e.isImport,"show-close":e.isImport},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"行政区划",prop:"districtCode"}},[a("el-cascader",{attrs:{placeholder:"请选择行政区域",options:e.disCodeOption,filterable:"","change-on-select":"",clearable:"",props:{value:"code"}},model:{value:e.dialogForm.districtCode,callback:function(t){e.$set(e.dialogForm,"districtCode",t)},expression:"dialogForm.districtCode"}})],1),a("el-form-item",{attrs:{label:"选择文件"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.sctionUrl,limit:1,"on-success":e.handleSuccess,"before-upload":e.beforeUpload,"show-file-list":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("导入数据")])],1)],1),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请填写名称"},model:{value:e.dialogForm.name,callback:function(t){e.$set(e.dialogForm,"name",t)},expression:"dialogForm.name"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success",size:"small",disabled:e.isImport},on:{click:e.submitForm}},[e._v("保存")])],1)],1)},s=[],c=(a("28a5"),a("cadf"),a("551c"),a("097d"),{props:{disCodeOption:{type:Array,default:[]}},data:function(){return{dialogVisible:!1,isImport:!0,dialogForm:{districtCode:[],name:""},rules:{districtCode:[{required:!0,message:"请选择行政区",trigger:"change"}],name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:12,message:"长度在 2 到 10 个字符",trigger:"blur"}]},sctionUrl:constants.SERVER_URL+"/fastdfs/file/upload"}},methods:{resetForm:function(){this.$refs["dialogForm"].resetFields(),this.dialogVisible=!1,this.dialogForm={districtCode:[],name:""},this.isImport=!0},submitForm:function(){var e=this;this.$refs["dialogForm"].validate(function(t){if(!t)return console.log("error submit!!"),!1;var a=_.cloneDeep(e.dialogForm);a.districtCode=_.last(a.districtCode),e.$emit("onSubmit",a)})},handleSuccess:function(e){this.isImport=!1,this.dialogForm.fileId=e.data.id,this.dialogForm.key=e.data.key,this.dialogForm.name=e.data.key},beforeUpload:function(e){var t="xlsx"===_.last(e.name.split(".")),a=e.size/1024/1024<100;return t||this.$message.error("上传文件只能是 XLSX 格式或者 XLS 格式!"),a||this.$message.error("上传头像图片大小不能超过 100MB!"),t&&a}}}),d=c,u=(a("150e"),a("2877")),m=Object(u["a"])(d,n,s,!1,null,null,null);m.options.__file="import-dialog.vue";var f=m.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-list"},[a("div",{staticClass:"header-btn"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""}},[a("a",{attrs:{href:e.fileUrl,download:e.fileName}},[e._v("下载数据模板")])]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleImport}},[e._v("导入数据")])],1),a("div",{staticClass:"techo-list__body-table"},[a("el-table",{ref:"table",attrs:{size:"medium",data:e.tableData,border:"","highlight-current-row":"","tooltip-effect":"dark",stripe:"",height:"100%","header-cell-class-name":"techo-list__body-table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"名称",prop:"name",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"导入人姓名",prop:"impUserName",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"导入结果",prop:"resultMass",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"下载导入报告",align:"center","show-overflow-tooltip":"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.resultFileId||void 0!=t.row.resultFileId?a("el-button",{attrs:{size:"mini",type:"success"}},[a("a",{attrs:{href:e.downloadUrl+t.row.resultFileId,download:"报告.xlsx"}},[e._v("下载导入报告")])]):e._e()]}}])})],1)],1)])},h=[],b={props:{fileUrl:{type:String,default:""},fileName:{type:String,default:""},tableData:{type:Array,default:[]}},data:function(){return{downloadUrl:constants.SERVER_URL+"/fastdfs/file/download/"}},methods:{handleImport:function(){this.$emit("onImport")}}},g=b,y=Object(u["a"])(g,p,h,!1,null,null,null);y.options.__file="import-list.vue";var v=y.exports,I={components:{ImportDialog:f,ImportList:v},data:function(){return{dataType:"1",tableData:[],page:1,pageSize:10,recordCount:0,disCodeOption:[],fileUrl:"./data/jzw.xlsx",fileName:"建筑物导入模板.xlsx",saveUrl:"building"}},mounted:function(){var e=this;l["a"].requestGridCode(function(t){e.disCodeOption=[t]}),this.$nextTick(function(){new r["a"](".el-table__body-wrapper",{mouseWheel:!0,scrollbar:{fade:!0,interactive:!1}}),e.handleQueryImportTask()})},methods:{handleImport:function(){this.$refs["ImportDialog"].dialogVisible=!0},handleClick:function(e){switch(e.name){case"1":this.fileUrl="./data/jzw.xlsx",this.fileName="建筑物数据导入模板.xlsx",this.saveUrl="building";break;case"2":this.fileUrl="./data/hu.xlsx",this.fileName="户数据导入模板.xlsx",this.saveUrl="house";break;case"3":this.fileUrl="./data/loudong.xlsx",this.fileName="流动人口数据导入模板.xlsx",this.saveUrl="people/flow";break;case"4":this.fileUrl="./data/huji.xlsx",this.fileName="户籍人口数据导入模板.xlsx",this.saveUrl="people/house";break;default:break}this.handleQueryImportTask()},getPageInfo:function(){void 0==this.$refs["pager"]?(this.page=1,this.pageSize=10):(this.page=this.$refs["pager"].internalCurrentPage,this.pageSize=this.$refs["pager"].internalPageSize),this.handleQueryImportTask()},handleQueryImportTask:function(){var e=this,t={page:this.page,pageSize:this.pageSize,dataType:this.dataType};l["a"].requestImportTask(t,function(t){e.recordCount=t.totalCount,e.tableData=t.list})},submitForm:function(e){var t=this;e.url=this.saveUrl,l["a"].requestSaveTask(e,function(e){t.$popup.showNotification({type:"success",message:"数据导入完成！"}),t.$refs["ImportDialog"].resetForm(),t.handleQueryImportTask()})}}},C=I,x=(a("2073"),Object(u["a"])(C,i,o,!1,null,null,null));x.options.__file="import-task.vue";t["default"]=x.exports},d937:function(e,t,a){}}]);
//# sourceMappingURL=chunk-0ab7.23ef802b.js.map