(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4759"],{"0c1e":function(e,t,i){},"1c95":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABH0lEQVQ4ja3VPUoDURTF8V9eQjo7C79Kd6AWsdMVREhchRZaGNyAoCm00FUENW7A0koRrFMqKXQDCoLFm4HJMJDBmQMDw+He/3u8efdM47Ozo0BtdJOngxX84B2vuMdD4s2oUQDcwwXWi1bKaIIB7rJmyLw3cZ4UzINJam6TnmZqtjIFZzgpAcor7Rlkd9j7JywL7aXANi4rwFJdoR3Qx1oNwFXsB/Fq1KVuwFaNwM0WlvLu4tNjqe6v7d28tRwU3PYqamGKhTkrl9U04K3iprJ6DhjXCBwHjMQUqaoPjNKPclwD8Ajf6SyPMKwAGyaMmfg6xfU/YDdJrzzwF4diakxKgCZiDhwkvShObGIC9cX03hAHn3jwL+IvYKRgKP4AU2M1xQEX6gkAAAAASUVORK5CYII="},"748d":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUMzRkY3QjhERTQxMTFFODhCNUU4RTczRUFCOUQyRTgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUMzRkY3QjlERTQxMTFFODhCNUU4RTczRUFCOUQyRTgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNTZBRUU3NURFM0YxMUU4OEI1RThFNzNFQUI5RDJFOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowNTZBRUU3NkRFM0YxMUU4OEI1RThFNzNFQUI5RDJFOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsflTEwAAAGUSURBVHja7JbLSsNAFIbTIq23aFAqFBStigvxsnQng+JOtOBOKO58D5c+hsxGkIIiikjFgKJbH8G9uhER0db4jRwhiClN0gYRB74TMpmZ/8zMmZNJeZ5nJVnSVsLl7wu2he6hVS/2EKqwbJXc5zDdU6GCRqsc9hQmTV+4gSUYhVlfS+PMLs5Uo89Qq0FsBYYhI7UzcCn1q7JFnZCT+ttoe6jVuAwwBO2+L1kY+1xay5pnRiM8p+IFjVbT2AvoF++/lw7Iw7U49hpdUKs5rAvdQlDpAhNMVzABb/AYLmi0WsAegGlgN7jTT/AORZb3vPEZarWCPZJos0NE/dcqHDPGYmOCWq1jy2DOlxPhbPfAC5wwVrG+oFab2B1Zmr4YCcWRPSwz5ka9GW5JQ6cJWcw4/ADbwYIlNw8m/AtNECww1oAcmQSTd8n14iRvT4j81wkraLLInkSxKWuSQ+1WCZpDfcYy7UtUOyLYsh9w7AtQOsIMExXM/FCXbYagSWu1AMF73/tdgBM1SW8xrxj/18TfKPghwAAcGl31TRkymQAAAABJRU5ErkJggg=="},7627:function(e,t,i){"use strict";var o=i("ceb8"),l=i.n(o);l.a},"7ba4":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"house-list-page"},[i("div",{staticClass:"build"},[i("div",{staticClass:"build-discode-tree"},[i("el-input",{attrs:{placeholder:"输入行政区关键字",size:"small",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),i("div",{staticStyle:{height:"calc(100% - 42px)",padding:"10px 0"}},[i("happy-scroll",{attrs:{size:"10",resize:""}},[i("el-tree",{ref:"tree",staticClass:"dis-code",attrs:{data:e.disCodeOption,"default-expanded-keys":e.isShowCode,"node-key":"code",accordion:"","filter-node-method":e.filterNode,"check-strictly":"","show-checkbox":""},on:{"check-change":e.handleCheckChange}})],1)],1)],1),i("div",{staticClass:"build-list-header"},[i("techo-icon",{staticClass:"build-icon",attrs:{name:"list-ul"}}),i("span",[e._v("楼栋列表")]),i("div",{staticClass:"build-tool"},[i("div",{staticClass:"build-tool-item",on:{click:e.resetForm}},[i("techo-icon",{attrs:{name:"plus"}}),i("span",[e._v("增加")])],1)])],1),i("div",{staticClass:"build-list-table"},[i("el-input",{attrs:{placeholder:"输入楼栋名称关键字",size:"small",disabled:""==e.editCheckId,clearable:""},model:{value:e.buildName,callback:function(t){e.buildName=t},expression:"buildName"}}),i("div",{staticClass:"build-list"},[i("happy-scroll",{attrs:{size:"10",resize:""}},[0===e.buildData.length?i("div",{staticClass:"build-item",staticStyle:{"justify-content":"center"}},[e._v("暂无数据")]):e._l(e.buildData,function(t,o){return i("div",{key:o,staticClass:"build-item",on:{click:function(i){e.handleBuildQueryHouse(t)}}},[i("div",{staticClass:"xuhao"},[e._v(e._s(o+1))]),i("div",{staticClass:"name",attrs:{title:t.name}},[e._v(e._s(t.name))]),i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){i.stopPropagation(),e.handleDeleteBuild(t)}}},[e._v("删除")])],1)})],2)],1)],1),i("div",{staticClass:"techo-list__pager"},[i("el-pagination",{ref:"pager",attrs:{"pager-count":5,"page-size":10,layout:"total, prev, pager, next",total:e.recordCount},on:{"current-change":e.handlePagerChange}})],1)]),i("div",{staticClass:"house"},[i("div",{staticClass:"build-list-header"},[i("techo-icon",{staticClass:"build-icon",attrs:{name:"wpforms"}}),i("span",[e._v("楼栋信息")])],1),i("div",{staticClass:"house-form"},[i("el-form",{ref:"buildForm",attrs:{model:e.buildForm,rules:e.rules,"label-width":"100px"}},[i("el-row",{attrs:{gutter:15}},[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"楼栋名称",prop:"name"}},[i("el-input",{attrs:{maxlength:25,placeholder:"小区名称+楼号；示例:幸福小区1号楼"},model:{value:e.buildForm.name,callback:function(t){e.$set(e.buildForm,"name",t)},expression:"buildForm.name"}})],1),i("el-form-item",{attrs:{label:"单元数",prop:"unitCount"}},[i("el-input",{attrs:{maxlength:10,placeholder:"请填写单元数"},model:{value:e.buildForm.unitCount,callback:function(t){e.$set(e.buildForm,"unitCount",t)},expression:"buildForm.unitCount"}})],1)],1),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"楼栋类型",prop:"type"}},[i("el-select",{attrs:{placeholder:"请选择楼栋类型",clearable:""},model:{value:e.buildForm.type,callback:function(t){e.$set(e.buildForm,"type",t)},expression:"buildForm.type"}},[i("el-option",{attrs:{label:"楼房",value:1}}),i("el-option",{attrs:{label:"平房",value:2}})],1)],1),i("el-form-item",{attrs:{label:"层数",prop:"floorCount"}},[i("el-input",{attrs:{maxlength:10,placeholder:"请填写层数"},model:{value:e.buildForm.floorCount,callback:function(t){e.$set(e.buildForm,"floorCount",t)},expression:"buildForm.floorCount"}})],1)],1),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{"label-width":"30px"}},[i("techo-position",{ref:"position",attrs:{code:e.editCheckId,placement:"bottom",width:"500",openType:"building",buttonName:"选择楼栋编码"},on:{onBuildInfo:e.handleBuildCode}}),i("div",{staticStyle:{display:"inline-flex","margin-left":"10px"}},[e._v(e._s(e.buildForm.buildingCode))])],1)],1)],1)],1),i("div",{staticClass:"footer-tool"},[i("div",{staticClass:"form-footer"},[i("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.resetForm}},[e._v("重置")]),i("el-button",{attrs:{type:"success",size:"small"},on:{click:e.submitForm}},[e._v(e._s(1==e.isUpdate?"更新":"保存"))])],1)]),i("div",{staticClass:"house-table"},[i("div",{staticClass:"build-list-header"},[i("techo-icon",{staticClass:"build-icon",attrs:{name:"list-ul"}}),i("span",[e._v("房列表")]),void 0!=e.buildInfo.id?i("el-popover",{attrs:{placement:"right",trigger:"click"},on:{hide:e.handleHideHousePopover},model:{value:e.visibleHousePopover,callback:function(t){e.visibleHousePopover=t},expression:"visibleHousePopover"}},[i("div",{staticStyle:{padding:"10px 0",color:"#f00","font-size":"18px"}},[e._v("注意：批量生成房信息时请确保此楼栋此单元中没有房信息！！！")]),i("div",{staticStyle:{display:"-webkit-flex"}},[i("div",{staticStyle:{color:"#f00","margin-right":"5px"}},[e._v("*")]),i("div",[e._v("单元")])]),i("el-checkbox-group",{staticStyle:{padding:"10px 0"},model:{value:e.unitCheckList,callback:function(t){e.unitCheckList=t},expression:"unitCheckList"}},e._l(e.buildInfo.unitCount,function(t,o){return i("el-checkbox",{key:o,attrs:{label:o+1}},[e._v(e._s(o+1)+" 单元")])})),0==e.unitCheckList.length?i("div",{staticStyle:{color:"#f90000","padding-bottom":"10px"}},[e._v("请选择单元")]):e._e(),i("div",{staticStyle:{display:"-webkit-flex"}},[i("div",{staticStyle:{color:"#f00","margin-right":"5px"}},[e._v("*")]),i("div",[e._v("每层房数")])]),i("div",{staticStyle:{padding:"10px 0"}},[i("el-input-number",{attrs:{size:"mini",step:2},model:{value:e.floorHouseNum,callback:function(t){e.floorHouseNum=t},expression:"floorHouseNum"}})],1),e.floorHouseNum<=0?i("div",{staticStyle:{color:"#f90000","padding-bottom":"10px"}},[e._v("请填写每层房数")]):e._e(),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:e.handleSaveHouse}},[e._v("生成")]),i("div",{staticStyle:{float:"right",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[i("techo-icon",{staticStyle:{"margin-right":"10px"},attrs:{name:"plus"}}),i("span",[e._v("生成房信息")])],1)],1):e._e()],1),i("vHouseInfo",{ref:"vHouseInfo",attrs:{buildInfo:e.buildInfo}})],1)],1)]),i("el-dialog",{staticClass:"house-table-dialog",attrs:{title:"房信息列表",visible:e.houseListVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.houseListVisible=t}}},[i("div",{staticClass:"table-info"},[e._v("请先删除楼栋下的房信息！")]),i("el-table",{ref:"houseTable",staticStyle:{width:"100%"},attrs:{size:"medium",data:e.houseDataList,border:"","highlight-current-row":"","tooltip-effect":"dark",stripe:"",height:"100%","header-cell-class-name":"techo-list__body-table-header"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[i("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),i("el-table-column",{attrs:{label:"房主姓名",prop:"householderName",align:"center"}}),i("el-table-column",{attrs:{label:"房主电话",prop:"householderPhone",align:"center"}}),i("el-table-column",{attrs:{label:"房号",prop:"houseNum",align:"center"}}),i("el-table-column",{attrs:{label:"单元",prop:"unit",align:"center"}}),i("el-table-column",{attrs:{label:"层数",prop:"floor",align:"center"}}),i("el-table-column",{attrs:{label:"房屋类型",prop:"type",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(1==t.row.type?"楼房":"平房"))])]}}])}),i("el-table-column",{attrs:{label:"是否有关联信息",fixed:"right",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:e.checkSelectable(t.$index,t.row)?"success":"danger"}}),i("span",[e._v(e._s(e.checkSelectable(t.$index,t.row)?"是":"否"))])]}}])})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"danger",size:"small",disabled:0==e.tableSelection.length},on:{click:e.handleDeleteHouse}},[e._v("删除房信息")])],1)],1),e.dlgVisible?i("techo-details",{ref:"details",attrs:{configKey:e.configKey,height:"60%"}}):e._e()],1)},l=[],s=(i("c5f6"),i("87aa")),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"house-list__pager"},[i("div",{staticClass:"hander-button"},e._l(e.buildInfo.unitCount,function(t,o){return i("el-button",{key:o,staticClass:"button-item",attrs:{plain:"",size:"small"},on:{click:function(t){e.handleUnit(o+1)}}},[i("techo-icon",{staticClass:"build-icon",staticStyle:{"margin-right":"5px"},attrs:{name:"check-square"}}),e._v(e._s(o+1)+" 单元")],1)})),i("div",{staticClass:"bottom-content"},[i("el-tabs",{staticClass:"build-floor-tabs",attrs:{"tab-position":"left"},model:{value:e.queryForm.floorCount,callback:function(t){e.$set(e.queryForm,"floorCount",t)},expression:"queryForm.floorCount"}},e._l(e.buildInfo.floorCount,function(t,o){return i("el-tab-pane",{key:o,attrs:{label:e.NumToString(o+1),name:String(o+1)}},[e._l(e.houseData,function(t,o){return i("div",{key:o,staticClass:"house-item",on:{click:function(i){i.stopPropagation(),e.handleViewHouse(t)},mousemove:function(t){t.stopPropagation(),e.isShowDel="show"+o},mouseout:function(t){t.stopPropagation(),e.isShowDel=""}}},[i("div",{staticClass:"house-name"},[e._v(e._s(t.houseNum))]),i("div",{staticClass:"house-img"},[e.isShowDel=="show"+o?i("div",{staticClass:"house-img-edit",on:{click:function(i){i.stopPropagation(),e.handleEditHouse(t)}}},[i("techo-icon",{attrs:{name:"pencil-square"}})],1):e._e(),i("img",{staticClass:"house_img",attrs:{src:1==t.dicMap.isHoldRelevance?e.houseImg:e.houseImg1}}),e.isShowDel=="show"+o?i("img",{staticClass:"el-icon-remove",attrs:{src:e.delImg},on:{click:function(i){i.stopPropagation(),e.handleDelHouse(t)}}}):e._e()]),i("div",{staticClass:"house-num"},[e._v(e._s(t.peopleCount)+" 人")])])}),i("div",{staticClass:"button-save",on:{click:e.handleSaveHouse}},[i("div",[e._v("+")])])],2)}))],1),i("vViewDialog",{ref:"vViewDialog",attrs:{title:e.title}}),i("vAddDialog",{ref:"vAddDialog"})],1)},n=[],u=i("bfd4"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"house-add-dialog",attrs:{title:e.title,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[i("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.teamRules,"label-width":"100px"}},[i("el-row",{attrs:{gutter:15}},[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"房号",prop:"houseNum"}},[i("el-input",{attrs:{maxlength:12,placeholder:"请填写户号"},model:{value:e.dialogForm.houseNum,callback:function(t){e.$set(e.dialogForm,"houseNum",t)},expression:"dialogForm.houseNum"}})],1),0==e.isAdd?i("el-form-item",{attrs:{label:"单元"}},[i("el-input",{attrs:{disabled:""},model:{value:e.dialogForm.unit,callback:function(t){e.$set(e.dialogForm,"unit",t)},expression:"dialogForm.unit"}})],1):e._e()],1),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"房主名称",prop:"householderName"}},[i("el-input",{attrs:{maxlength:12,placeholder:"请填写户主名称"},model:{value:e.dialogForm.householderName,callback:function(t){e.$set(e.dialogForm,"householderName",t)},expression:"dialogForm.householderName"}})],1),0==e.isAdd?i("el-form-item",{attrs:{label:"层数"}},[i("el-input",{attrs:{disabled:""},model:{value:e.dialogForm.floor,callback:function(t){e.$set(e.dialogForm,"floor",t)},expression:"dialogForm.floor"}})],1):e._e()],1),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"房主电话",prop:"householderPhone"}},[i("el-input",{attrs:{maxlength:12,placeholder:"请填写户主联系方式"},model:{value:e.dialogForm.householderPhone,callback:function(t){e.$set(e.dialogForm,"householderPhone",t)},expression:"dialogForm.householderPhone"}})],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.resetForm}},[e._v("取消")]),i("el-button",{attrs:{type:"success",size:"small"},on:{click:e.submitForm}},[e._v("保存")])],1)],1)},c=[],d=(i("7f7f"),i("ac6a"),{components:{},data:function(){return{dialogVisible:!1,isAdd:!0,title:"",dic:{"户口类型":[]},dialogForm:{},teamRules:{houseNum:[{required:!0,message:"请输入户号",trigger:"blur"},{min:2,max:12,message:"长度在 2 到 12 个字符",trigger:"blur"}],householderName:[{required:!0,message:"请输入户主姓名",trigger:"blur"}],householderPhone:[{required:!0,message:"请输入户主联系方式",trigger:"blur"},util.validate.tellAndPhone()],type:[{required:!0,message:"请选择户类型",trigger:"change"}]}}},created:function(){var e=this;s["a"].requestDicCatalog(function(t){var i=_.keys(e.dic);_.map(t,function(t){-1!=_.indexOf(i,t.name)&&s["a"].requestDicType(t.id,function(i){e.dic[t.name]=i})})})},methods:{submitForm:function(){var e=this;this.$refs["dialogForm"].validate(function(t){if(!t)return console.log("error submit!!"),!1;var i=_.cloneDeep(e.dialogForm);i.dicMap&&delete i.dicMap,1==e.isAdd?s["a"].requestSaveHouse(i,function(t){e.$popup.showNotification({type:"success",message:"户信息添加成功！"}),e.resetForm(),e.$parent.handleQueryHouse()}):0==e.isAdd&&s["a"].requestUpdateHouse(i,function(t){e.$popup.showNotification({type:"success",message:"户信息修改成功！"}),e.resetForm(),e.$parent.handleQueryHouse()})})},resetForm:function(){this.$refs["dialogForm"].resetFields(),this.$data.dialogVisible=!1,this.isAdd=!0,this.dialogForm={}}}}),h=d,p=(i("855e"),i("2877")),m=Object(p["a"])(h,r,c,!1,null,null,null);m.options.__file="house-info-add.vue";var g=m.exports,f={components:{vViewDialog:u["a"],vAddDialog:g},props:{buildInfo:{type:Object,default:function(){return{unitCount:"",floorCount:""}}}},data:function(){return{title:"户信息",isShowDel:"",queryForm:{unitCount:"1",floorCount:"1"},houseData:[],houseImg:i("a670"),houseImg1:i("748d"),delImg:i("1c95")}},watch:{queryForm:{handler:function(e){void 0!=this.buildInfo.id&&this.handleQueryHouse()},deep:!0},buildInfo:function(){var e=this;this.$nextTick(function(){e.handleUnit(1),$(".button-item").each(function(e,t){0==e&&(t.className+=" button-active")}),e.queryForm={unitCount:"1",floorCount:"1"}})}},methods:{handleViewHouse:function(e){this.$refs["vViewDialog"].dialogVisible=!0,this.$refs["vViewDialog"].houseInfo=_.cloneDeep(e)},handleEditHouse:function(e){this.$refs["vAddDialog"].dialogVisible=!0,this.$refs["vAddDialog"].isAdd=!1,this.$refs["vAddDialog"].title="修改"+this.title,this.$refs["vAddDialog"].dialogForm=_.cloneDeep(e)},handleDelHouse:function(e){var t=this,i="",o="";e.dicMap.isHoldRelevance&&(i="户下有关联信息，请慎重操作！",o="游离数据请到数据关联菜单下重新关联！"),this.$popup.showConfirm({message:"你确定要删除选中户？"+i,successFunc:function(){t.$popup.showLoading("正在删除中，请稍候..."),new Promise(function(t,i){1==e.dicMap.isHoldRelevance?(e.buildingId=null,delete e.dicMap,s["a"].requestUpdateHouse(e,function(e){t()})):s["a"].requestDeleteHouse(e.id,function(e){t()})}).then(function(){t.$popup.closeLoading(),t.$popup.showNotification({type:"success",message:"户删除成功！"+o}),t.handleQueryHouse()})}})},handleSaveHouse:function(){this.$refs["vAddDialog"].dialogVisible=!0,this.$refs["vAddDialog"].isAdd=!0,this.$refs["vAddDialog"].title="添加"+this.title;var e={buildingId:this.buildInfo.id,districtCode:this.buildInfo.districtCode,floor:this.queryForm.floorCount,unit:this.queryForm.unitCount};this.$refs["vAddDialog"].dialogForm=e},handleQueryHouse:function(){var e=this,t=_.cloneDeep(this.queryForm);t.buildingId=this.buildInfo.id,s["a"].requestBuildByHouse(t,function(t){_.map(t.list,function(e){e.dicMap.isHoldRelevance=0!=e.peopleCount||0!=e.companyCount||0!=e.placeCount||0!=e.schoolCount}),e.houseData=t.list})},handleUnit:function(e){this.queryForm.unitCount=e,$(".button-item").each(function(e,t){t.className+="el-button button-item el-button--default el-button--small is-plain"});var t=t||window.event;t.currentTarget.className+=" button-active"},NumToString:function(e){return e+"层"}}},b=f,v=(i("c1be"),Object(p["a"])(b,a,n,!1,null,null,null));v.options.__file="house-info.vue";var C=v.exports,A={components:{vHouseInfo:C},data:function(){return{title:"房信息",isUpdate:!1,buildData:[],isShowCode:["6102"],page:1,pageSize:10,recordCount:0,buildForm:{name:"",type:"",buildingCode:"",unitCount:"",floorCount:"",districtCode:[]},buildInfo:{},rules:{name:[{required:!0,message:"请输入楼栋名称",trigger:"blur"},{min:2,max:25,message:"长度在 2 到 25 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择楼栋类型",trigger:"change"}],unitCount:[{required:!0,message:"请输入层数",trigger:"blur"},util.validate.valiInteger()],floorCount:[{required:!0,message:"请输入层数",trigger:"blur"},util.validate.valiInteger()]},disCodeOption:[],filterText:"",editCheckId:"",buildName:"",dlgVisible:!1,configKey:"houseView",houseListVisible:!1,houseDataList:[],tableSelection:[],deleteBuildInfo:{},unitCheckList:[],floorHouseNum:0,visibleHousePopover:!1}},watch:{filterText:function(e){this.$refs.tree.filter(e)},buildName:function(e){this.handleQuery()}},mounted:function(){var e=this;s["a"].requestGridCode(function(t){e.disCodeOption=[t],e.isShowCode=[t.code]})},methods:{handleBuildCode:function(e){this.buildForm.buildingCode=e.CODE},handleSaveHouse:function(){var e=this;if(0!=this.unitCheckList.length&&this.floorHouseNum>0){var t=this,i=[];this.$popup.showLoading("正在批量添加房信息，请稍候..."),_.map(t.unitCheckList,function(e){for(var o=1;o<=t.buildInfo.floorCount;o++)for(var l=1;l<=t.floorHouseNum;l++)i.push({buildingId:t.buildInfo.id,districtCode:t.buildInfo.districtCode,houseNum:e+""+(o<10?"0"+o:o)+(l<10?"0"+l:l),unit:e,floor:o})}),s["a"].requestMadeHouse(i,function(i){t.$popup.showNotification({type:"success",message:"房批量添加成功！"}),e.visibleHousePopover=!1,e.$refs["vHouseInfo"].handleQueryHouse(),e.$popup.closeLoading()})}},handleHideHousePopover:function(){this.unitCheckList=[],this.floorHouseNum=0},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleCheckChange:function(e,t,i){1==t?(this.editCheckId=e.code,this.$refs.tree.setCheckedKeys([e.code]),this.handleQuery(),this.resetForm()):this.editCheckId==e.code&&this.$refs.tree.setCheckedKeys([e.code])},handlePagerChange:function(){void 0==this.$refs["pager"]?(this.page=1,this.pageSize=10):(this.page=this.$refs["pager"].internalCurrentPage,this.pageSize=this.$refs["pager"].internalPageSize),this.handleQuery()},handleBuildQueryHouse:function(e){$(".build-item").each(function(e,t){t.className="build-item"});var t=t||window.event;t.currentTarget.className+=" actived-item",this.isUpdate=!0,this.buildForm=_.cloneDeep(e),this.buildInfo=_.cloneDeep(e)},handlePageChange:function(){this.buildData=[],this.handleQuery()},handleQuery:function(e){var t=this,i={page:this.page,pageSize:this.pageSize,districtCode:this.editCheckId,name:this.buildName};s["a"].requestPageBuild(i,function(i){t.recordCount=i.totalCount,t.buildData=i.list,e&&e()})},submitForm:function(){var e=this;""==this.editCheckId?this.$popup.showNotification({message:"请先选取行政区！"}):this.$refs["buildForm"].validate(function(t){if(!t)return console.log("error submit!!"),!1;var i=_.cloneDeep(e.buildForm);0==e.isUpdate?(i.districtCode=e.editCheckId,s["a"].requestSaveBuild(i,function(t){e.$popup.showNotification({type:"success",message:"楼栋信息添加成功！"}),e.resetForm(),e.handleQuery()})):s["a"].requestUpdateBuild(i,function(t){e.$popup.showNotification({type:"success",message:"楼栋信息修改成功！"}),e.handleQuery(function(){var t=_.cloneDeep(e.buildForm);t.unitCount=Number(t.unitCount),t.floorCount=Number(t.floorCount),e.buildInfo=t})})})},resetForm:function(){this.$refs["buildForm"].resetFields(),this.isUpdate=!1,this.buildForm={name:"",type:"",buildingCode:"",unitCount:"",floorCount:"",districtCode:[]},this.buildInfo={},$(".build-item").each(function(e,t){t.className="build-item"})},handleDeleteBuild:function(e){var t=this;new Promise(function(t,i){s["a"].requestBuildByHouse({page:1,pageSize:1,buildingId:e.id},function(e){t(e)})}).then(function(i){0!=i.totalCount?(t.houseDataList=i.list,t.houseListVisible=!0,t.deleteBuildInfo=e):(t.deleteBuildInfo={},s["a"].requestDeleteBuild(e.id,function(e){t.handleQuery()}))})},handleRowClick:function(e){this.$refs.houseTable.toggleRowSelection(e)},handleSelectionChange:function(e){this.tableSelection=e},checkSelectable:function(e,t){return(0!=t.peopleCount||0!=t.companyCount||0!=t.placeCount||0!=t.schoolCount)&&(t.isHoldRelevance=!0,!0)},handleDeleteHouse:function(){var e=this,t=this,i=_.compact(_.map(this.tableSelection,"isHoldRelevance")).length,o="",l="";0!=i&&(o="房下有关联信息，请慎重操作！",l="游离数据请到数据关联菜单下重新关联！"),this.$popup.showConfirm({message:"你确定要删除选中房？"+o,successFunc:function(){t.$popup.showLoading("正在删除中，请稍候..."),new Promise(function(e,i){var o=0;_.map(t.tableSelection,function(i,l){i.isHoldRelevance?(i.buildingId=null,delete i.isHoldRelevance,s["a"].requestUpdateHouse(i,function(i){o++,o==t.tableSelection.length&&e()})):s["a"].requestDeleteHouse(i.id,function(i){o++,o==t.tableSelection.length&&e()})})}).then(function(){e.handleDeleteBuild(e.deleteBuildInfo),e.houseListVisible=!1,t.$popup.closeLoading(),t.$popup.showNotification({type:"success",message:"房删除成功！"+l})}).catch(function(){t.$popup.showNotification({message:"房删除失败！"}),t.$popup.closeLoading()})}})}}},w=A,F=(i("7627"),Object(p["a"])(w,o,l,!1,null,null,null));F.options.__file="build-info-list.vue";t["default"]=F.exports},"855e":function(e,t,i){"use strict";var o=i("aa1f"),l=i.n(o);l.a},a670:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDU2QUVFNzNERTNGMTFFODhCNUU4RTczRUFCOUQyRTgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDU2QUVFNzRERTNGMTFFODhCNUU4RTczRUFCOUQyRTgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNTZBRUU3MURFM0YxMUU4OEI1RThFNzNFQUI5RDJFOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowNTZBRUU3MkRFM0YxMUU4OEI1RThFNzNFQUI5RDJFOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkAE5wgAAAGTSURBVHja7Ja9SgNBEMeTEBK/oocSIeBXVCzEj9LOQrETDdjZ2Nn4FJY+gA9gJ0hAEUVEUVC09RHEVm1ERPTi+RsY4RAv3O5dDhEXfgzZ7M5/dnd2btOe56WSbJlUwu3vC2ZNJ/Rtuh2YfXBh/m4t+2IyP22SNIgVMccwKnPhBuZgECZ9QyWYbYJxrVeIWA/mBPohp90TcKn9i3pELVDU/lurM0RsWB30QpPvrzwMydbCNCsawI5FShrExjEX0KXRf2/NUIJrDezNWhAHU5hzaFOCWitIMl3BCLzDk1HSIDaD2QMZUAh51M/wARW29yz0ChFbwBxothUMsv5rFw7xMRtKkIHLmCrI/XIs7nY7vMIRvip1BRmwitnSremMUFAcPcMqPlfqrXBdBzoxVDEJ+BE2AgU56BJI+pdjECzjq1uvTHLFG1EvSvH2FOuvjqmgVJEdzWJpS1pDC40SlEt9yjbtalY7KtiwD3DkB1DGYoWJCuZ+6MvHIShlrRYg+OD7fR8QRE3LW7Qnxv8z8VcKfgowACEka72/PzdEAAAAAElFTkSuQmCC"},aa1f:function(e,t,i){},c1be:function(e,t,i){"use strict";var o=i("0c1e"),l=i.n(o);l.a},ceb8:function(e,t,i){}}]);
//# sourceMappingURL=chunk-4759.91429493.js.map